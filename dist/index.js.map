{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { App, InjectionKey } from \"vue\";\nimport {\n  AppConfigurationClient,\n  featureFlagPrefix,\n  isFeatureFlag,\n  parseFeatureFlag,\n} from \"@azure/app-configuration\";\n\ninterface FeatureFlagsManager {\n  getFeaturedFlag(name: string, label?: string): Promise<boolean>;\n}\n\nconst featureFlagsManager = (connectionString: string): FeatureFlagsManager => {\n  let client: AppConfigurationClient | null = null;\n\n  if (connectionString) {\n    client = new AppConfigurationClient(connectionString);\n  }\n\n  return {\n    async getFeaturedFlag(name: string, label = \"default\") {\n      if (!client) {\n        console.warn(\n          \"[App Configuration Plugin] AppConfigurationClient is not initialized.\"\n        );\n        return false;\n      }\n      try {\n        const response = await client.getConfigurationSetting({\n          key: `${featureFlagPrefix}${name}`,\n          label,\n        });\n\n        if (!isFeatureFlag(response)) return false;\n        return parseFeatureFlag(response).value.enabled;\n      } catch (error) {\n        console.error(\n          \"[App Configuration Plugin] Error fetching feature flag.\",\n          error\n        );\n        return false;\n      }\n    },\n  };\n};\n\nconst FeatureFlagsManagerKey: InjectionKey<FeatureFlagsManager> = Symbol(\n  \"FeatureFlagsManager\"\n);\n\nexport default {\n  install(app: App, connectionString: string) {\n    app.provide(FeatureFlagsManagerKey, featureFlagsManager(connectionString));\n  },\n  FeatureFlagsManagerKey,\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,+BAKO;AAMP,IAAM,sBAAsB,CAAC,qBAAkD;AAC7E,MAAI,SAAwC;AAE5C,MAAI,kBAAkB;AACpB,aAAS,IAAI,gDAAuB,gBAAgB;AAAA,EACtD;AAEA,SAAO;AAAA,IACC,gBAAgB,MAAc,QAAQ,WAAW;AAAA;AACrD,YAAI,CAAC,QAAQ;AACX,kBAAQ;AAAA,YACN;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AACA,YAAI;AACF,gBAAM,WAAW,MAAM,OAAO,wBAAwB;AAAA,YACpD,KAAK,GAAG,0CAAiB,GAAG,IAAI;AAAA,YAChC;AAAA,UACF,CAAC;AAED,cAAI,KAAC,wCAAc,QAAQ;AAAG,mBAAO;AACrC,qBAAO,2CAAiB,QAAQ,EAAE,MAAM;AAAA,QAC1C,SAAS,OAAO;AACd,kBAAQ;AAAA,YACN;AAAA,YACA;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAAA,MACF;AAAA;AAAA,EACF;AACF;AAEA,IAAM,yBAA4D;AAAA,EAChE;AACF;AAEA,IAAO,cAAQ;AAAA,EACb,QAAQ,KAAU,kBAA0B;AAC1C,QAAI,QAAQ,wBAAwB,oBAAoB,gBAAgB,CAAC;AAAA,EAC3E;AAAA,EACA;AACF;","names":[]}