{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import {\n  AppConfigurationClient,\n  featureFlagPrefix,\n  isFeatureFlag,\n  parseFeatureFlag,\n} from \"@azure/app-configuration\";\nimport { type App, type InjectionKey } from \"vue\";\n\ntype GetFeatureFlagFunction = (\n  name: string,\n  label?: string\n) => Promise<boolean>;\n\ninterface FeatureFlagsManager {\n  getFeatureFlag: GetFeatureFlagFunction;\n}\n\nconst FeatureFlagsManagerKey: InjectionKey<{\n  getFeatureFlag: GetFeatureFlagFunction;\n}> = Symbol(\"FeatureFlagsManager\");\n\nconst featureFlagsManager = (\n  connectionString?: string\n): FeatureFlagsManager => {\n  let client: AppConfigurationClient | null = null;\n\n  if (connectionString) {\n    client = new AppConfigurationClient(connectionString);\n  }\n\n  const getFeatureFlag = async (\n    name: string,\n    label?: string\n  ): Promise<boolean> => {\n    if (!client) return false;\n    try {\n      const response = await client.getConfigurationSetting({\n        key: `${featureFlagPrefix}${name}`,\n        label,\n      });\n      if (!isFeatureFlag(response)) return false;\n      return parseFeatureFlag(response).value.enabled;\n    } catch (error) {\n      console.error(\n        \"[App Configuration Plugin] Error retrieving feature flag.\",\n        error\n      );\n      return false;\n    }\n  };\n\n  return { getFeatureFlag };\n};\n\nfunction AppConfigurationPlugin(app: App, connectionString?: string) {\n  app.provide(FeatureFlagsManagerKey, featureFlagsManager(connectionString));\n}\n\nexport { AppConfigurationPlugin, FeatureFlagsManagerKey };\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAKO;AAYP,IAAM,yBAED,OAAO,qBAAqB;AAEjC,IAAM,sBAAsB,CAC1B,qBACwB;AACxB,MAAI,SAAwC;AAE5C,MAAI,kBAAkB;AACpB,aAAS,IAAI,gDAAuB,gBAAgB;AAAA,EACtD;AAEA,QAAM,iBAAiB,CACrB,MACA,UACqB;AACrB,QAAI,CAAC;AAAQ,aAAO;AACpB,QAAI;AACF,YAAM,WAAW,MAAM,OAAO,wBAAwB;AAAA,QACpD,KAAK,GAAG,0CAAiB,GAAG,IAAI;AAAA,QAChC;AAAA,MACF,CAAC;AACD,UAAI,KAAC,wCAAc,QAAQ;AAAG,eAAO;AACrC,iBAAO,2CAAiB,QAAQ,EAAE,MAAM;AAAA,IAC1C,SAAS,OAAO;AACd,cAAQ;AAAA,QACN;AAAA,QACA;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAAA,EACF;AAEA,SAAO,EAAE,eAAe;AAC1B;AAEA,SAAS,uBAAuB,KAAU,kBAA2B;AACnE,MAAI,QAAQ,wBAAwB,oBAAoB,gBAAgB,CAAC;AAC3E;","names":[]}