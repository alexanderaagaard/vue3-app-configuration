{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { App, InjectionKey } from \"vue\";\nimport {\n  AppConfigurationClient,\n  featureFlagPrefix,\n  isFeatureFlag,\n  parseFeatureFlag,\n} from \"@azure/app-configuration\";\n\ninterface FeatureFlagsManager {\n  getFeaturedFlag(name: string, label?: string): Promise<boolean>;\n}\n\nconst featureFlagsManager = (\n  connectionString?: string\n): FeatureFlagsManager => {\n  let client: AppConfigurationClient | null = null;\n\n  if (connectionString) {\n    client = new AppConfigurationClient(connectionString);\n  }\n\n  return {\n    async getFeaturedFlag(name: string, label = \"default\") {\n      if (!client) {\n        console.warn(\n          \"[App Configuration Plugin] AppConfigurationClient is not initialized.\"\n        );\n        return false;\n      }\n      try {\n        const response = await client.getConfigurationSetting({\n          key: `${featureFlagPrefix}${name}`,\n          label,\n        });\n\n        if (!isFeatureFlag(response)) return false;\n        return parseFeatureFlag(response).value.enabled;\n      } catch (error) {\n        console.error(\n          \"[App Configuration Plugin] Error fetching feature flag.\",\n          error\n        );\n        return false;\n      }\n    },\n  };\n};\n\nconst FeatureFlagsManagerKey: InjectionKey<FeatureFlagsManager> = Symbol(\n  \"FeatureFlagsManager\"\n);\n\nfunction AppConfigurationPlugin(app: App, connectionString?: string) {\n  app.provide(FeatureFlagsManagerKey, featureFlagsManager(connectionString));\n}\n\nexport { FeatureFlagsManagerKey, AppConfigurationPlugin };\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AACA;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACK;AAMP,IAAM,sBAAsB,CAC1B,qBACwB;AACxB,MAAI,SAAwC;AAE5C,MAAI,kBAAkB;AACpB,aAAS,IAAI,uBAAuB,gBAAgB;AAAA,EACtD;AAEA,SAAO;AAAA,IACC,gBAAgB,MAAc,QAAQ,WAAW;AAAA;AACrD,YAAI,CAAC,QAAQ;AACX,kBAAQ;AAAA,YACN;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AACA,YAAI;AACF,gBAAM,WAAW,MAAM,OAAO,wBAAwB;AAAA,YACpD,KAAK,GAAG,iBAAiB,GAAG,IAAI;AAAA,YAChC;AAAA,UACF,CAAC;AAED,cAAI,CAAC,cAAc,QAAQ;AAAG,mBAAO;AACrC,iBAAO,iBAAiB,QAAQ,EAAE,MAAM;AAAA,QAC1C,SAAS,OAAO;AACd,kBAAQ;AAAA,YACN;AAAA,YACA;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAAA,MACF;AAAA;AAAA,EACF;AACF;AAEA,IAAM,yBAA4D;AAAA,EAChE;AACF;AAEA,SAAS,uBAAuB,KAAU,kBAA2B;AACnE,MAAI,QAAQ,wBAAwB,oBAAoB,gBAAgB,CAAC;AAC3E;","names":[]}